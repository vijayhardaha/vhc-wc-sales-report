!function(e){new class{constructor(){this.noticeTimeout=!1,this.registerNoticeEvents(),this.registerDatePickerEvents(),this.togglePeriods(),this.registerFormEvents()}getElement(t){return e(document).find(t)}showNotice(e="info",t="",r=!0){const o=this;clearTimeout(o.noticeTimeout),o.getElement(".notice-wrap").remove();const n=`<div class="notice-wrap"><div class="notice-alert notice-${e}"><span class="notice-icon"><svg height="24" width="24" viewBox="0 0 24 24"><g><path d="${"success"===e?"M9 19.414l-6.707-6.707 1.414-1.414L9 16.586 20.293 5.293l1.414 1.414":"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}"></path></g></svg></span><span class="notice-content"><span class="notice-text">${t}</span></span><span role="button" tabindex="0" class="dismiss"><svg height="24" width="24" viewBox="0 0 24 24"><g><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></g></svg></span></div></div>`;o.getElement(".vhc-wc-sr-container").append(n),r&&(o.noticeTimeout=setTimeout((function(){o.getElement(".notice-wrap").fadeOut().remove()}),3e3))}clearNotice(){this.getElement(".notice-wrap").remove()}registerNoticeEvents(){const t=this;e(document).on("click",".notice-alert .dismiss",(function(r){r.preventDefault(),e(this).parents(".notice-alert").hide().remove(),t.getElement(".notice-wrap").length&&""===t.getElement(".notice-wrap").html().trim()&&t.getElement(".notice-wrap").remove()}))}registerDatePickerEvents(){const e=this;e.getElement(".setting-field .datepicker").length&&e.getElement(".setting-field .datepicker").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"-100:+1",maxDate:"0"})}registerFormEvents(){const t=this;e(document).on("click",".vhc-wc-sr-form .view-report",(function(r){r.preventDefault();const o=e(r.currentTarget).closest("form");o.find("input[name='download']").val(0),t.clearNotice(),e(".vhc-wc-sr-container .report-preview").empty(),e.ajax({type:"POST",url:vhc_wc_sales_report_params.ajax_url,data:o.serialize(),dataType:"json",beforeSend(){o.find('[type="button"]').attr("disabled",!0),t.showNotice("info",vhc_wc_sales_report_params.i18n_generating_report,!1)},success(r){t.clearNotice(),r.success?(e(".vhc-wc-sr-container .report-preview").html(r.data.html),e(".vhc-wc-sr-container .report-preview table").DataTable({aLengthMenu:[[10,15,20,25,30],[10,15,20,25,30]],iDisplayLength:15,order:[]}),e("html, body").animate({scrollTop:e(".vhc-wc-sr-container .report-preview").offset().top-50})):t.showNotice("error",vhc_wc_sales_report_params.i18n_something_wrong)},error(){o.find('[type="button"]').attr("disabled",!1),t.showNotice("error",vhc_wc_sales_report_params.i18n_something_wrong)},complete(){o.find('[type="button"]').attr("disabled",!1)}})})).on("click",".vhc-wc-sr-form .download-report",(function(r){r.preventDefault();const o=e(r.currentTarget).closest("form");o.find("input[name=download]").val(1),t.clearNotice(),e(".vhc-wc-sr-container .report-preview").empty(),e.ajax({type:"POST",url:vhc_wc_sales_report_params.ajax_url,data:o.serialize(),dataType:"json",beforeSend(){o.find("[type=button]").attr("disabled",!0),t.showNotice("info",vhc_wc_sales_report_params.i18n_generating_csv,!1)},success(e){e.success?(document.querySelector(".vhc-wc-sr-form .download-url").setAttribute("href",e.data.download_url),document.querySelector(".vhc-wc-sr-form .download-url").click(),t.showNotice("success",vhc_wc_sales_report_params.i18n_csv_downloaded)):t.showNotice("error",vhc_wc_sales_report_params.i18n_something_wrong)},error(){o.find("[type=button]").attr("disabled",!1),t.showNotice("error",vhc_wc_sales_report_params.i18n_something_wrong)},complete(){o.find('[type="button"]').attr("disabled",!1)}})})).on("change",".vhc-wc-sr-form :input#setting-period",(function(){t.togglePeriods(e(this).val())}))}togglePeriods(e=""){""===e&&(e=this.getElement(".vhc-wc-sr-form :input#setting-period").val()),"custom"===e?this.getElement(".vhc-wc-sr-form #setting-row-date-range").slideDown():this.getElement(".vhc-wc-sr-form #setting-row-date-range").slideUp()}}}(jQuery);